#!/usr/bin/env bpftrace

BEGIN
{
    // Print the header row
    printf("%-18s %-6s %-16s %-15s %-6s %s\n",
           "TIME", "PID", "COMM", "EVENT", "FD", "PATH/ARG");
}

tracepoint:syscalls:sys_enter_rename,
tracepoint:syscalls:sys_enter_renameat,
tracepoint:syscalls:sys_enter_renameat2
{
    printf("%-18s %-6d %-16s %-15s %-6s %s -> %s\n",
           strftime("%H:%M:%S", nsecs/1000000000), pid, comm, "RENAME", "-", str(args->oldname), str(args->newname));
}
